<!doctype html><html lang=en><head><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-5DPTBV6Q")</script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Automating Deployments with Kamal and GitHub Actions | Lazy-Bison </title><meta name=description content="Comprehensive guide to automating Ruby on Rails web app deployments using Kamal and GitHub Actions. Includes installation guide and sample GitHub Actions configuration."><meta name=keywords content="Kamal,GitHub Actions,Web App Deployment,Automation,CI/CD Pipeline,Ruby,Ruby on Rails,Developers"><meta name=author content="Lazy Bison"><meta property="og:title" content="Lazy Bison - Your Trusted Partner in Ruby on Rails Development"><meta property="og:description" content="We provide top-notch Ruby on Rails development services tailored to meet the unique needs of start-ups and SMEs."><meta property="og:image" content="https://thelazybison.com/assets/images/logo_h.png"><meta property="og:url" content="https://thelazybison.com"><meta property="og:type" content="website"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Lazy Bison - Expert Ruby on Rails Development"><meta name=twitter:description content="Offering reliable and scalable Ruby on Rails development services for start-ups and SMEs."><meta name=twitter:image content="https://thelazybison.com/assets/images/logo_h.png"><link rel=icon type=image/png href=/icons/favicon.svg><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css><link rel=stylesheet href=/css/style.min.a192029d8175aed9c0d76341d60776f7afcbaa34ab18e1fff939156c63abff49.css integrity="sha256-oZICnYF1rtnA12NB1gd296/LqjSrGOH/+TkVbGOr/0k=" crossorigin=anonymous></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5DPTBV6Q" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><header class=header><div class=container><div class=header__inner><div class=header__logo><a class="'logo" href=/ style=display:inline-block;padding:10px><img class=logo-img src=/icons/logo.svg alt="Lazy Bison logo" title="Lazy Bison logo"></a></div><nav class=header__main-nav><ul class="header__main-nav-list text--medium"><li class=header__main-nav-item><a href=/#services class=header__main-nav-link>Services</a></li><li class=header__main-nav-item><a href=/#explore class=header__main-nav-link>Explore</a></li><li class=header__main-nav-item><a href=/blogs class=header__main-nav-link>Blogs</a></li><li class=header__main-nav-item><a href=/cases class=header__main-nav-link>Cases</a></li><li class=header__main-nav-item><a href=/#testimonials class=header__main-nav-link>Testimonials</a></li></ul></nav><button class="button header__contact-us-button button__text--medium button--secondary get-consultation-btn">
Contact us
</button>
<button class=burger-menu-button aria-label="Toggle menu">
<span class=line></span>
<span class=line></span>
<span class=line></span></button></div></div></header><main><div class="wrapper blog-page__wrapper"><section class=section-full-info-blog><div class=container><div class=section-full-info-blog__inner><div class=container__navigation-path><nav class=navigation-path><a class=navigation-path__link href=http://localhost:1313/>Home</a>
<span>/</span>
<a class=navigation-path__link href=/blogs>Blogs</a>
<span>/</span>
<a class="navigation-path__link navigation-path__link--active" href=http://localhost:1313/blogs/2023-12-06-automating-deployments-blog/>Automating Deployments with Kamal and GitHub Actions</a></nav></div><article class=full-info-blog><header class=full-info__header><h1 class=blog-page__title-h1>Automating Deployments with Kamal and GitHub Actions</h1><div class=author-time-blog><div class=author><img src=/images/blogs/2023-11-29-blog/author-blog.svg class=author__avatar alt=author></img><p class=author__name>MARIE CAPHLISH</p></div><span>|</span><div class=time>Dec 6, 2023</div></div><ul class=categories-list><li class=categories-item><span class="category category--active">#DevOps</span></li></ul><div class=blog-post-image__wrapper><img class=blog-post-image src=/images/blogs/2023-11-29-blog/blog-preview-img.png alt="Blog Image"></div></header><section class=full-info-blog__section><h2 id=introduction-simplify-your-deployments>Introduction: Simplify Your Deployments</h2><p>Learn how to automate your web app deployments using Kamal and GitHub Actions. This comprehensive guide covers installation, setup, and includes a sample configuration for seamless deployments.</p><h2 id=detailed-guide-to-installing-kamal>Detailed Guide to Installing Kamal</h2><p>For a more in-depth look at installation and configuration, check out this <a href="https://www.notion.so/Effortless-Deployment-of-Web-Applications-with-Kamal-394073d1007149aaad561f17dae7ff9a?pvs=21">detailed post</a>.</p><h3 id=easy-steps-to-install-kamal>Easy Steps to Install Kamal</h3><ol><li><p><strong>Direct Installation</strong>: Execute <code>bundle add kamal</code> to add the gem to your Ruby project.</p><ul><li><strong>Compatibility Note</strong>: May not work with older Ruby on Rails versions.</li></ul></li><li><p><strong>Avoiding Version Conflicts</strong>: To avoid version conflicts in Ruby on Rails versions lower than 6, it is recommended to set up a separate Gemfile.</p><ul><li>Create a file named <code>gemfiles/kamal.Gemfile</code> and populate it with:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span> source <span style=color:#e6db74>&#39;&lt;https://rubygems.org&gt;&#39;</span>
</span></span><span style=display:flex><span> gem <span style=color:#e6db74>&#39;kamal&#39;</span>, <span style=color:#e6db74>&#39;~&gt; 1.0.0&#39;</span>
</span></span></code></pre></div></li></ol><ul><li>Generate a runnable directory: <code>BUNDLE_GEMFILE=kamal/Gemfile bundle binstub kamal --path ../bin</code>.<ul><li>Run <code>BUNDLE_GEMFILE=kamal/Gemfile bundle install</code>.</li></ul></li></ul><p>After these steps, you can run <code>bin/kamal</code> from the console, which is particularly useful for GitHub Actions.</p><h2 id=the-importance-of-automation-in-web-development>The Importance of Automation in Web Development</h2><p>Automation not only streamlines your workflow but also reduces errors and saves valuable time. Learn why Kamal combined with GitHub Actions is the ultimate solution for a robust, automated deployment pipeline.</p><h2 id=how-to-set-up-github-actions>How to Set Up GitHub Actions</h2><p>Create a <code>.github/workflows/</code> directory in your repository. Add a YAML file for your workflow and securely store sensitive data like passwords and keys using GitHub Secrets.</p><h2 id=integrating-kamal-with-github-actions-for-seamless-deployments>Integrating Kamal with GitHub Actions for Seamless Deployments</h2><p>Learn how to integrate Kamal into your GitHub Actions workflow for consistent and secure deployments.</p><h2 id=sample-github-actions-configuration-for-ruby-on-rails>Sample GitHub Actions Configuration for Ruby on Rails</h2><p>Here&rsquo;s a sample <code>.github/workflows/staging_deploy.yml</code> based on your configuration:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Staging deploy&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>branches</span>: [ <span style=color:#e6db74>&#39;develop&#39;</span> ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>concurrency</span>: <span style=color:#ae81ff>staging_environment</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>deploy</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-20.04</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     <span style=color:#75715e># change it</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>RAILS_MASTER_KEY</span>: <span style=color:#ae81ff>${{ secrets.RAILS_MASTER_KEY }}</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>DOCKER_REGISTRY_USERNAME</span>: <span style=color:#ae81ff>${{ secrets.DOCKERHUB_USERNAME }}</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>DOCKER_REGISTRY_PASSWORD</span>: <span style=color:#ae81ff>${{ secrets.DOCKERHUB_PASSWORD }}</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>MYSQL_ROOT_PASSWORD</span>: <span style=color:#ae81ff>${{ secrets.MYSQL_ROOT_PASSWORD }}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Check out the repo</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>SSH Auth</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>webfactory/ssh-agent@v0.8.0</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>ssh-private-key</span>: <span style=color:#ae81ff>${{ secrets.STAGING_KEY }}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e># Need for registry cache</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Set up Docker Buildx</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>docker/setup-buildx-action@v2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Install Kamal</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>ruby/setup-ruby@v1</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>BUNDLE_GEMFILE</span>: <span style=color:#ae81ff>./gemfiles/kamal.gemfile</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>ruby-version</span>: <span style=color:#ae81ff>2.7.8</span> <span style=color:#75715e># change it</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>bundler-cache</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Update server envs</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>kamal env push -d staging</span>
</span></span><span style=display:flex><span>       <span style=color:#75715e># run: ./bin/kamal env push -d staging</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>kamal deploy -d staging</span>
</span></span><span style=display:flex><span>       <span style=color:#75715e># run: ./bin/kamal deploy -d staging</span>
</span></span></code></pre></div><h2 id=conclusion-enhance-your-cicd-pipeline-with-kamal-and-github-actions>Conclusion: Enhance Your CI/CD Pipeline with Kamal and GitHub Actions</h2><p>Automating deployments with Kamal and GitHub Actions significantly enhances your CI/CD pipeline, making it efficient, secure, and developer-friendly.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>meta</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;description&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Comprehensive guide to automating Ruby on Rails web app deployments using Kamal and GitHub Actions. Includes installation guide and sample GitHub Actions configuration.&#34;</span>
</span></span><span style=display:flex><span>/&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>meta</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;keywords&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Kamal, GitHub Actions, Web App Deployment, Automation, CI/CD Pipeline, Ruby, Ruby on Rails, Developers&#34;</span>
</span></span><span style=display:flex><span>/&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;author&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Lazy Bison&#34;</span> /&gt;
</span></span></code></pre></div></section></article></div></section><div class=container><div class=gray-line__container><hr class=gray-line></div></div><section class=section-recommendations><div class=container><div class=section-recommendations__inner><h2 class=blog-page__title-h2>Recommendations</h2><ul class=blogs-list><li class=blogs-item><article class=card-blog><div class=card-blog__content><h3 class=card-blog__title>Automating Deployments with Kamal and GitHub Actions</h3><p class=card-blog__description>Navigating the intricacies of web application deployment can be a daunting task. Enter Kamal—a deployment tool designed to alleviate these complexities. In this article, we'll delve into the key features of Kamal and share insights from our own hands-on experience.</p><div class=card-blog__category-container><span class=category>#DevOps</span></div><span class=card-blog__date>Dec 6, 2023</span></div><a href=http://localhost:1313/blogs/2023-12-06-automating-deployments-blog/ class="button button--primary card-blog__btn">Read More
<i class="icon arrow-right-top-angle-square-transparent-bg"></i></a></article></li><li class=blogs-item><article class=card-blog><div class=card-blog__content><h3 class=card-blog__title>Effortless Deployment of Web Applications with Kamal</h3><p class=card-blog__description>Navigating the intricacies of web application deployment can be a daunting task. Enter Kamal—a deployment tool designed to alleviate these complexities. In this article, we'll delve into the key features of Kamal and share insights from our own hands-on experience.</p><div class=card-blog__category-container><span class=category>#DevOps</span></div><span class=card-blog__date>Dec 6, 2023</span></div><a href=http://localhost:1313/blogs/2023-12-06-effortless-deployment-blog/ class="button button--primary card-blog__btn">Read More
<i class="icon arrow-right-top-angle-square-transparent-bg"></i></a></article></li></li></ul></div></div></section></div></main><footer class=footer><div class=container><div class=footer__inner><div class=footer__logo-container><a class="'logo" href=/ style=display:inline-block;padding:10px><img class=logo-img src=/icons/logo.svg alt="Lazy Bison logo" title="Lazy Bison logo"></a></div><div class=footer__menu><h4 class=footer__menu-title>Menu</h4><nav><ul class="footer-menu__list text--small"><li class=footer__menu-item><a href=/#services class=footer__menu-link>Services</a></li><li class=footer__menu-item><a href=/#explore class=footer__menu-link>Explore</a></li></li><li class=footer__menu-item><a href=/#blogs class=footer__menu-link>Blogs</a></li><li class=footer__menu-item><a href=/#cases class=footer__menu-link>Cases</a></li><li class=footer__menu-item><a href=/#testimonials class=footer__menu-link>Testimonials</a></li></ul></nav></div><div class=footer__contacts><h4 class=footer__contacts-title>Contacts</h4><address class=contacts-info><a class=website href=https://www.lazy-bison.com>www.lazy-bison.com
</a><a class=email href=mailto:contact@thelazybison.com>contact@thelazybison.com
</a><a class=address href="https://www.google.com/maps/search/?api=1&query=Warsaw,Poland">Poland, Warsaw</a></address><div class="social-media text--small"><a href=https://www.facebook.com/example><i class="icon icon-facebook"></i>
</a><a href=https://www.twitter.com/example><i class="icon icon-twitter"></i>
</a><a href=https://www.instagram.com/example><i class="icon icon-linkedin"></i></a></div></div></div><p class=rights>&copy;
<time datetime=2023>2023</time>
Lazy Bison. All RightsReserved.</p></div></footer><div id=get-consultation class="popup popup__get-consultation"><div class=popup-content><h2 class=get-consultation__title>Get free consultation</h2><p class="get-consultation__subtitle text--medium">Please, fill out the form</p><div class=form-wrapper><form class="form invalid" novalidate action=https://formspree.io/f/xaygwovq method=POST><div class=form-group><label class="text--small label-email" for=email>E-mail
<span class=input-email__wrapper><i class="icon error-icon"></i>
<input class=input-email placeholder=exapmle@gmail.com type=email id=email name=email required>
</span><span class=error-text>Invalid e-mail</span></label><div class=textarea__container><label class=text--small for=comments>Your comments
<textarea class=textarea placeholder="Write your comments (optional)" id=comments name=message maxlength=360></textarea></label><div class="character-count text--small">0/360</div></div><label class="checkbox-label text--small" for=agree><input class=checkbox type=checkbox id=agree name=agree required>
<span class=checkbox-custom></span>
Agree to process personal data</label></div><p id=my-form-status></p><div class=form-actions><button type=button class="btn btn-cancel">Cancel</button>
<button type=submit class="btn btn-submit">Submit</button></div></form></div><div class=success-submit-block><h2 class=get-consultation__title>Congratulations!</h2><p class="get-consultation__subtitle text--medium"><span>Your request is sent successfully. </span><span>Our manager will contact you shortly.</span></p><i class="icon two-ticks"></i></div></div><button class=close-popup-button></button></div><div class=overlay></div><script src=https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js></script><script src=http://localhost:1313/js/main.min.js></script></body></html>